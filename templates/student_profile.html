{% extends "base.html" %}
{% block title %}My Profile Â· EduManage Pro{% endblock %}

{% block header %}
<!-- Hide default header on mobile -->
{% endblock %}

{% block content %}
<!-- Mobile App Bar -->
<div class="mobile-app-bar d-lg-none">
    <div class="d-flex align-items-center justify-content-center p-3">
        <h1 class="h5 mb-0 fw-bold text-dark">My Profile</h1>
    </div>
</div>

<!-- Desktop Header -->
<div class="d-none d-lg-block mb-4">
    <div class="d-flex justify-content-between align-items-center">
        <h2 class="fw-bold"><i class="fas fa-user-circle text-primary me-3"></i>My Profile</h2>
    </div>
</div>

<!-- Profile Card -->
<div class="premium-card p-4 mb-4 text-center">
    <div class="avatar-circle bg-primary text-white mx-auto mb-3">
        {{ student.first_name[0]|upper }}{{ student.last_name[0]|upper }}
    </div>
    <h3 class="fw-bold">{{ student.first_name }} {{ student.last_name }}</h3>
    <p class="text-muted mb-2">{{ student.student_id }}</p>
    <div class="d-flex justify-content-center gap-2">
        <span class="badge bg-primary">Student</span>
        {% if student.is_active %}
        <span class="badge bg-success">Active</span>
        {% else %}
        <span class="badge bg-secondary">Inactive</span>
        {% endif %}
    </div>
</div>

<!-- Personal Information -->
<div class="premium-card p-4 mb-4">
    <h5 class="mb-3"><i class="fas fa-info-circle text-primary me-2"></i>Personal Information</h5>
    <div class="row g-3">
        <div class="col-6">
            <div class="text-muted small">First Name</div>
            <div class="fw-bold">{{ student.first_name }}</div>
        </div>
        <div class="col-6">
            <div class="text-muted small">Last Name</div>
            <div class="fw-bold">{{ student.last_name }}</div>
        </div>
        <div class="col-6">
            <div class="text-muted small">Date of Birth</div>
            <div class="fw-bold">{{ student.date_of_birth.strftime('%d %b %Y') }}</div>
        </div>
        <div class="col-6">
            <div class="text-muted small">Gender</div>
            <div class="fw-bold">{{ student.gender|title }}</div>
        </div>
        <div class="col-12">
            <div class="text-muted small">Address</div>
            <div class="fw-bold">{{ student.address or 'Not provided' }}</div>
        </div>
    </div>
</div>

<!-- Academic Information -->
<div class="premium-card p-4 mb-4">
    <h5 class="mb-3"><i class="fas fa-graduation-cap text-primary me-2"></i>Academic Information</h5>
    <div class="row g-3">
        {% if enrollment %}
        <div class="col-6">
            <div class="text-muted small">Class</div>
            <div class="fw-bold">{{ enrollment.class_.name }}</div>
        </div>
        <div class="col-6">
            <div class="text-muted small">Roll Number</div>
            <div class="fw-bold">{{ enrollment.roll_number }}</div>
        </div>
        <div class="col-6">
            <div class="text-muted small">Session</div>
            <div class="fw-bold">{{ enrollment.session.name }}</div>
        </div>
        <div class="col-6">
            <div class="text-muted small">Enrollment Date</div>
            <div class="fw-bold">{{ enrollment.enrollment_date.strftime('%d %b %Y') }}</div>
        </div>
        {% else %}
        <div class="col-12">
            <p class="text-muted">Not enrolled in any class for the current session.</p>
        </div>
        {% endif %}
    </div>
</div>

<!-- Parent / Guardian Information -->
<div class="premium-card p-4 mb-4">
    <h5 class="mb-3"><i class="fas fa-users text-primary me-2"></i>Parent / Guardian</h5>
    <div class="row g-3">
        <div class="col-6">
            <div class="text-muted small">Father's Name</div>
            <div class="fw-bold">{{ student.father_name or 'Not provided' }}</div>
        </div>
        <div class="col-6">
            <div class="text-muted small">Mother's Name</div>
            <div class="fw-bold">{{ student.mother_name or 'Not provided' }}</div>
        </div>
        <div class="col-6">
            <div class="text-muted small">Phone</div>
            <div class="fw-bold">{{ student.phone or 'Not provided' }}</div>
        </div>
        <div class="col-6">
            <div class="text-muted small">Parent Email</div>
            <div class="fw-bold">{{ student.parent_email or 'Not provided' }}</div>
        </div>
    </div>
</div>

<!-- Account Information -->
<div class="premium-card p-4 mb-4">
    <h5 class="mb-3"><i class="fas fa-shield-alt text-primary me-2"></i>Account Information</h5>
    <div class="row g-3">
        <div class="col-6">
            <div class="text-muted small">Login Email</div>
            <div class="fw-bold">{{ student.email }}</div>
        </div>
        <div class="col-6">
            <div class="text-muted small">Account Created</div>
            <div class="fw-bold">{{ student.created_at.strftime('%d %b %Y') }}</div>
        </div>
        <div class="col-6">
            <div class="text-muted small">Last Login</div>
            <div class="fw-bold">{{ student.user.last_login.strftime('%d %b %Y') if student.user and student.user.last_login else 'Never' }}</div>
        </div>
        <div class="col-6">
            <div class="text-muted small">Password</div>
            <div class="fw-bold">
                <span class="badge bg-warning">Changeable</span>
            </div>
        </div>
    </div>
    <div class="mt-3">
        <a href="{{ url_for('change_password', force=true) }}" class="btn btn-outline-warning w-100">
            <i class="fas fa-key me-2"></i>Change Password
        </a>
    </div>
</div>

<style>
:root { --safe-bottom: env(safe-area-inset-bottom, 0px); }
body { background-color: #f8fafc; padding-bottom: 80px; }

.premium-card {
    background: white;
    border-radius: 20px;
    border: 1px solid rgba(226,232,240,0.6);
    box-shadow: 0 4px 12px rgba(0,0,0,0.02);
}

.avatar-circle {
    width: 20px;
    height: 27px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    font-weight: 600;
    background: linear-gradient(135deg, #667eea, #764ba2);
}

.mobile-app-bar {
    background: white;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    margin-bottom: 1rem;
    position: sticky;
    top: 0;
    z-index: 900;
    width: 100%;
}
.mobile-app-bar h1 {
    font-size: 1.25rem;
    letter-spacing: 0.3px;
}

@media (min-width: 992px) {
    body { padding-bottom: 0; }
}
</style>
{% endblock %}
